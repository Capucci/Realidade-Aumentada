<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferramenta de Desenvolvimento AR</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mind-ar-image.prod.js"></script>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mind-ar-image-aframe.prod.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #1e1e1e;
            color: #fff;
            min-height: 100vh;
        }
        
        .container {
            display: grid;
            grid-template-columns: 400px 1fr;
            height: 100vh;
        }
        
        .sidebar {
            background: #2d2d2d;
            padding: 20px;
            border-right: 1px solid #444;
            overflow-y: auto;
        }
        
        .preview-area {
            background: #000;
            display: flex;
            flex-direction: column;
        }
        
        .ar-container {
            flex: 1;
            position: relative;
        }
        
        .controls {
            background: #2d2d2d;
            padding: 15px;
            border-top: 1px solid #444;
        }
        
        h1, h2, h3 {
            color: #fff;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
            font-size: 14px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 8px 12px;
            background: #3d3d3d;
            border: 1px solid #555;
            border-radius: 4px;
            color: #fff;
            font-size: 14px;
        }
        
        textarea {
            height: 80px;
            resize: vertical;
            font-family: monospace;
        }
        
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px 0;
            width: 100%;
            font-size: 14px;
        }
        
        button:hover {
            background: #005a9e;
        }
        
        button.secondary {
            background: #555;
        }
        
        button.success {
            background: #28a745;
        }
        
        .file-info {
            background: #3d3d3d;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 12px;
            color: #ccc;
        }
        
        .code-preview {
            background: #1e1e1e;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            color: #ccc;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .tab-buttons {
            display: flex;
            margin-bottom: 15px;
        }
        
        .tab-button {
            flex: 1;
            background: #3d3d3d;
            border: none;
            padding: 10px;
            color: #ccc;
            cursor: pointer;
        }
        
        .tab-button.active {
            background: #007acc;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #ccc;
        }
        
        .hidden {
            display: none;
        }
        
        .status-bar {
            background: #007acc;
            color: white;
            padding: 5px 10px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar de Desenvolvimento -->
        <div class="sidebar">
            <h2>üõ†Ô∏è Desenvolvimento AR</h2>
            
            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('assets')">Assets</button>
                <button class="tab-button" onclick="showTab('config')">Configura√ß√£o</button>
                <button class="tab-button" onclick="showTab('export')">Exportar</button>
            </div>
            
            <!-- Tab: Assets -->
            <div id="assets-tab" class="tab-content active">
                <div class="form-group">
                    <label>üéØ Imagem Target (Marcador):</label>
                    <input type="file" id="targetImage" accept="image/*">
                    <div class="file-info" id="targetInfo">Nenhum arquivo selecionado</div>
                </div>
                
                <div class="form-group">
                    <label>üì¶ Modelo 3D (GLTF/GLB):</label>
                    <input type="file" id="model3d" accept=".gltf,.glb,.fbx">
                    <div class="file-info" id="modelInfo">Nenhum arquivo selecionado</div>
                </div>
                
                <div class="form-group">
                    <label>üîä √Åudio (MP3/WAV):</label>
                    <input type="file" id="audioFile" accept="audio/*">
                    <div class="file-info" id="audioInfo">Nenhum arquivo selecionado</div>
                </div>
                
                <button onclick="loadAssets()">üì• Carregar Assets</button>
            </div>
            
            <!-- Tab: Configura√ß√£o -->
            <div id="config-tab" class="tab-content">
                <div class="form-group">
                    <label>üìè Escala do Modelo:</label>
                    <input type="text" id="modelScale" value="0.1 0.1 0.1" placeholder="x y z">
                </div>
                
                <div class="form-group">
                    <label>üìç Posi√ß√£o:</label>
                    <input type="text" id="modelPosition" value="0 0 0.1" placeholder="x y z">
                </div>
                
                <div class="form-group">
                    <label>üîÑ Rota√ß√£o:</label>
                    <input type="text" id="modelRotation" value="0 0 0" placeholder="x y z">
                </div>
                
                <div class="form-group">
                    <label>üé≠ Anima√ß√£o:</label>
                    <select id="animationType">
                        <option value="none">Sem Anima√ß√£o</option>
                        <option value="rotation">Rota√ß√£o</option>
                        <option value="bounce">Bounce</option>
                        <option value="pulse">Pulse</option>
                        <option value="custom">Customizada</option>
                    </select>
                </div>
                
                <div class="form-group" id="customAnimationGroup" style="display: none;">
                    <label>‚öôÔ∏è Anima√ß√£o Customizada:</label>
                    <textarea id="customAnimation" placeholder='property: rotation; to: 0 360 0; loop: true; dur: 5000'></textarea>
                </div>
                
                <div class="form-group">
                    <label>üîä Comportamento do √Åudio:</label>
                    <select id="audioBehavior">
                        <option value="autoplay">Tocar automaticamente</option>
                        <option value="onClick">Tocar ao clicar</option>
                        <option value="loop">Loop cont√≠nuo</option>
                    </select>
                </div>
                
                <button onclick="applyConfig()">‚ö° Aplicar Configura√ß√µes</button>
            </div>
            
            <!-- Tab: Exportar -->
            <div id="export-tab" class="tab-content">
                <div class="form-group">
                    <label>üè∑Ô∏è Nome do Projeto:</label>
                    <input type="text" id="projectName" value="meu-projeto-ar">
                </div>
                
                <div class="form-group">
                    <label>üìÅ Exportar Como:</label>
                    <select id="exportType">
                        <option value="html">Arquivo HTML √önico</option>
                        <option value="zip">Projeto Completo (ZIP)</option>
                    </select>
                </div>
                
                <button class="success" onclick="generateProject()">üì¶ Gerar Projeto</button>
                <button onclick="generateQRCode()">üì± Gerar QR Code</button>
                
                <div class="code-preview" id="codePreview">
                    // Preview do c√≥digo gerado aparecer√° aqui
                </div>
            </div>
        </div>
        
        <!-- √Årea de Preview -->
        <div class="preview-area">
            <div class="status-bar" id="statusBar">
                Pronto para desenvolver - Fa√ßa upload dos assets para come√ßar
            </div>
            
            <div class="ar-container">
                <div id="loading" class="loading">
                    <p>‚è≥ Aguardando configura√ß√£o...</p>
                    <p>Use o painel lateral para carregar assets</p>
                </div>
                
                <a-scene 
                    id="ar-scene"
                    mindar-image="imageTargetSrc: #target; autoStart: false; uiLoading: no; uiScanning: no; uiError: no;"
                    color-space="sRGB"
                    embedded
                    renderer="colorManagement: true, physicallyCorrectLights"
                    vr-mode-ui="enabled: false"
                    device-orientation-permission-ui="enabled: false">
                    
                    <a-assets>
                        <img id="target" crossOrigin="anonymous">
                        <audio id="soundEffect" src=""></audio>
                    </a-assets>

                    <a-camera active="false" position="0 0 0"></a-camera>

                    <a-entity mindar-image-target="targetIndex: 0">
                        <!-- Modelo 3D ser√° inserido aqui -->
                    </a-entity>
                </a-scene>
            </div>
            
            <div class="controls">
                <button onclick="startAR()">üé• IniciAR AR</button>
                <button class="secondary" onclick="stopAR()">‚èπÔ∏è ParAR AR</button>
                <button onclick="screenshot()">üì∏ Capturar Tela</button>
            </div>
        </div>
    </div>

    <script>
        let currentAssets = {
            targetImage: null,
            model3d: null,
            audio: null
        };

        // Sistema de tabs
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        // Gerenciamento de arquivos
        document.getElementById('targetImage').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('targetInfo').textContent = 
                    `${file.name} (${(file.size/1024).toFixed(1)}KB)`;
                currentAssets.targetImage = file;
            }
        });

        document.getElementById('model3d').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('modelInfo').textContent = 
                    `${file.name} (${(file.size/1024).toFixed(1)}KB)`;
                currentAssets.model3d = file;
            }
        });

        document.getElementById('audioFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('audioInfo').textContent = 
                    `${file.name} (${(file.size/1024).toFixed(1)}KB)`;
                currentAssets.audio = file;
            }
        });

        // Toggle anima√ß√£o customizada
        document.getElementById('animationType').addEventListener('change', function(e) {
            document.getElementById('customAnimationGroup').style.display = 
                e.target.value === 'custom' ? 'block' : 'none';
        });

        // Carregar assets na cena
        function loadAssets() {
            if (!currentAssets.targetImage) {
                alert('Selecione uma imagem target primeiro!');
                return;
            }

            const statusBar = document.getElementById('statusBar');
            statusBar.textContent = 'Carregando assets...';

            // Carregar imagem target
            const targetElement = document.getElementById('target');
            const reader = new FileReader();
            
            reader.onload = function(e) {
                targetElement.src = e.target.result;
                
                // Configurar cena b√°sica
                setupScene();
                
                document.getElementById('loading').classList.add('hidden');
                statusBar.textContent = 'Assets carregados! AplicAR configura√ß√µes ou iniciAR AR.';
                
                // Gerar preview do c√≥digo
                generateCodePreview();
            };
            
            reader.readAsDataURL(currentAssets.targetImage);
        }

        // Configurar cena AR
        function setupScene() {
            const scene = document.getElementById('ar-scene');
            const targetEntity = scene.querySelector('[mindar-image-target]');
            
            // Limpar cena anterior
            targetEntity.innerHTML = '';
            
            // Adicionar modelo b√°sico (ser√° substitu√≠do por configura√ß√£o)
            const box = document.createElement('a-box');
            box.setAttribute('color', '#4CC3D9');
            box.setAttribute('position', '0 0 0.1');
            box.setAttribute('scale', '0.1 0.1 0.1');
            targetEntity.appendChild(box);
        }

        // Aplicar configura√ß√µes
        function applyConfig() {
            const scene = document.getElementById('ar-scene');
            const targetEntity = scene.querySelector('[mindar-image-target]');
            const model = targetEntity.children[0];
            
            // Aplicar transforma√ß√µes
            model.setAttribute('scale', document.getElementById('modelScale').value);
            model.setAttribute('position', document.getElementById('modelPosition').value);
            model.setAttribute('rotation', document.getElementById('modelRotation').value);
            
            // Aplicar anima√ß√£o
            const animationType = document.getElementById('animationType').value;
            if (animationType !== 'none') {
                const animationConfig = getAnimationConfig(animationType);
                model.setAttribute('animation', animationConfig);
            } else {
                model.removeAttribute('animation');
            }
            
            generateCodePreview();
        }

        function getAnimationConfig(type) {
            const configs = {
                rotation: 'property: rotation; to: 0 360 0; loop: true; dur: 5000',
                bounce: 'property: position; to: 0 0.2 0.1; dir: alternate; loop: true; dur: 1000',
                pulse: 'property: scale; to: 0.15 0.15 0.15; dir: alternate; loop: true; dur: 800',
                custom: document.getElementById('customAnimation').value
            };
            return configs[type] || '';
        }

        // Controles AR
        function startAR() {
            const scene = document.getElementById('ar-scene');
            const arSystem = scene.systems["mindar-image-system"];
            arSystem.start();
            document.getElementById('statusBar').textContent = 'AR ativo - Aponte para o target';
        }

        function stopAR() {
            const scene = document.getElementById('ar-scene');
            const arSystem = scene.systems["mindar-image-system"];
            arSystem.stop();
            document.getElementById('statusBar').textContent = 'AR parado';
        }

        function screenshot() {
            alert('Funcionalidade de screenshot ser√° implementada!');
        }

        // Gerar preview do c√≥digo
        function generateCodePreview() {
            const scale = document.getElementById('modelScale').value;
            const position = document.getElementById('modelPosition').value;
            const rotation = document.getElementById('modelRotation').value;
            const animation = document.getElementById('animationType').value;
            
            const code = `
<a-entity mindar-image-target="targetIndex: 0">
    <a-box
        color="#4CC3D9"
        position="${position}"
        rotation="${rotation}"
        scale="${scale}"
        ${animation !== 'none' ? `animation="${getAnimationConfig(animation)}"` : ''}
    ></a-box>
</a-entity>`;
            
            document.getElementById('codePreview').textContent = code;
        }

        // Gerar projeto
        function generateProject() {
            const projectName = document.getElementById('projectName').value || 'meu-projeto-ar';
            const exportType = document.getElementById('exportType').value;
            
            if (exportType === 'html') {
                generateHTMLFile(projectName);
            } else {
                alert('Exporta√ß√£o ZIP ser√° implementada em breve!');
            }
        }

        function generateHTMLFile(projectName) {
            const htmlContent = generateCompleteHTML();
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${projectName}.html`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function generateCompleteHTML() {
            // Aqui voc√™ geraria o HTML completo com todas as configura√ß√µes
            return `<!DOCTYPE html>
<html>
<head>
    <title>Projeto AR</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mind-ar-image.prod.js"></script>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mind-ar-image-aframe.prod.js"></script>
</head>
<body>
    <a-scene mindar-image="imageTargetSrc: assets/target.mind" ...>
        <!-- Sua cena AR aqui -->
    </a-scene>
</body>
</html>`;
        }

        function generateQRCode() {
            alert('QR Code ser√° gerado para a URL do projeto quando hospedado!');
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Ferramenta de desenvolvimento AR carregada!');
        });
    </script>
</body>
</html>
